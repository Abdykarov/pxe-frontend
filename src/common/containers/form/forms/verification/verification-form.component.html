<ng-template #sendSmsAgainTemplate>
    <a (click)="submitSms()"
       *ngIf="smsSent">
        Poslat SMS kód znovu?
    </a>
</ng-template>
<form
    [formGroup]="form"
    autocomplete="off"
    (keydown)="resetCustomFieldError()"
    (keydown.enter)="submitForm($event);false"
    (change)="resetCustomFieldError()">
    <div [ngClass]="classMainWrapper">
        <div *ngIf="showDisabledInput || smsSent"
             [ngClass]="classFirstField">
            <div class="form-container ml-0 ml-md-auto mr-md-0">
                <lnd-form-field
                    lndSFormDirective
                    lndSBiometricsDirective
                    label="Kód z SMS"
                    [disabledField]="!smsSent"
                    [error]="formError.smsCode || form.controls.smsCode.errors"
                    [formControl]="form.controls.smsCode"
                    [id]="'smsCode'"
                    [subtextTemplate]="sendSmsAgainTemplate"
                    [success]="form.controls.smsCode.valid && (form.controls.smsCode.touched || formError.smsCode)"
                    [touched]="form.controls.smsCode.touched || formError.smsCode"
                    [triggerFocus]="smsSent"
                    [validationMessages]="formFields.validationMessages.smsCode">
                </lnd-form-field>
            </div>
        </div>
        <ng-container *ngIf="infoTemplate && smsSent">
            <ng-container *ngTemplateOutlet="infoTemplate; context: { contract: this.contract }"></ng-container>
        </ng-container>
        <div [ngClass]="classSecondField">
            <lnd-button
                *ngIf="!smsSent"
                (action)="submitSms();sAnalyticsService.sFormClick($event)"
                [isDisabled]="formLoading"
                [label]="sendSmsLabel"
                type="primary">
            </lnd-button>
            <lnd-button
                *ngIf="smsSent"
                (action)="submitForm();sAnalyticsService.sFormClick($event)"
                [isDisabled]="formLoading"
                [label]="submitLabelText"
                type="primary">
            </lnd-button>
            <p *ngIf="!smsSent && !showSentSmsLabelUnderFirstField"
                class="small mt-2">
                Ověřovací SMS kód odešleme<br>na číslo {{phone}}
            </p>
        </div>
    </div>
</form>
